---
type: pull_request
state: open
branch: release/0.2.0 → main
created: 2026-02-23T12:55:29Z
updated: 2026-02-24T17:22:04Z
author: vig-os-release-app[bot]
author_url: https://github.com/vig-os-release-app[bot]
url: https://github.com/vig-os/sync-issues-action/pull/22
comments: 9
labels: none
assignees: c-vigo
milestone: none
projects: none
relationship: none
synced: 2026-02-25T01:47:07.144Z
---

# [PR 22](https://github.com/vig-os/sync-issues-action/pull/22) Release 0.2.0

## Release 0.2.0

This PR prepares release 0.2.0 for merge to main.

### Release Content

### Added

- Exported `shiftHeadersToMinLevel` utility function for independent unit testing
- **Sync sub-issue relationships into frontmatter** ([#8](https://github.com/vig-os/sync-issues-action/issues/8), [#15](https://github.com/vig-os/sync-issues-action/issues/15))
  - Fetch `parent` and `subIssues` via GraphQL batch query for all synced issues
  - New `sync-sub-issues` action input to control sub-issue syncing (default: `true`)
  - Replace hardcoded `relationship: none` with dynamic `parent` and `children` fields
  - Graceful degradation: emits info message and falls back to `none` if the sub-issues API is unavailable
- **CI/CD pipeline** ([#13](https://github.com/vig-os/sync-issues-action/issues/13))
  - CI workflow with lint, build-dist verification, and test jobs
  - Integration test suite as a reusable workflow with parallel jobs covering issues-only, PRs-only, force-update, include-closed, sub-issues, updated-since, state-file, and default-mode scenarios
  - Three-phase release pipeline: prepare-release (branch + draft PR), release (tag + GitHub Release with provenance attestation), and post-release (dev sync + CHANGELOG reset)
  - `setup-env` and `build-dist` composite actions for consistent environment setup
  - CHANGELOG management CLI (`prepare_changelog.py`) for automated release note preparation
  - Dependabot configuration for automated dependency updates
  - CODEOWNERS file for automated review assignment

### Changed

- **Sync-issues workflow uses local action checkout** ([#13](https://github.com/vig-os/sync-issues-action/issues/13))
  - Replaced pinned remote ref with `uses: ./` so the workflow always tests the current branch's code
- **Node.js version pinned via `.nvmrc`** ([#13](https://github.com/vig-os/sync-issues-action/issues/13))
  - `.nvmrc` is the single source of truth; `setup-env` and devcontainer read from it

### Fixed

- Corrected heading hierarchy in `formatPRAsMarkdown`: promoted the Comments section header from `##` to `#` and individual comment entry headers from `###` to `##`
- **`--force-update` does not re-sync issues (only PRs)** ([#10](https://github.com/vig-os/sync-issues-action/issues/10))
  - Added `force-update` action input that bypasses the `hasContentChanged` content-comparison gate
  - When active, all fetched items are re-written (with updated `synced:` frontmatter) even if body content is unchanged
  - Updated `sync-issues.yml` workflow to pass the `force-update` dispatch input to the action
- Added `shiftHeadersToMinLevel` helper to re-level headers inside comment bodies so the shallowest header maps to `###`, preventing collisions with outer document structure
- Fixed default `GITHUB_REPOSITORY` in `test-local.sh` from non-existent `vig-os/actions` to `vig-os/sync-issues-action`
- Removed broken fallback command in `test-local.sh` that passed a file path where a directory is required

### Security

- **CodeQL and OpenSSF Scorecard analysis workflows** ([#13](https://github.com/vig-os/sync-issues-action/issues/13))
  - CodeQL scans JavaScript/TypeScript on push and PR
  - Scorecard publishes results to the Security tab via SARIF

### Testing Checklist
- [ ] All tests pass (`npm run test:coverage`)
- [ ] Manual testing complete
- [ ] No critical bugs found
- [ ] Ready for release

### When Ready to Release
Run the **Release** workflow (`workflow_dispatch`) with version `0.2.0`.

This will:
- Bump package.json version
- Set release date in CHANGELOG
- Run full test suite on finalized code
- Create release tag (v0.2.0) and GitHub Release
- Attest build provenance

### Related
- Release automation: #13



---
---

## Comments (2)

### [Comment #1](https://github.com/vig-os/sync-issues-action/pull/22#issuecomment-3944709131) by [@c-vigo](https://github.com/c-vigo)

_Posted on February 23, 2026 at 01:11 PM_

@gerchowl
- should release branches be write-protected?
- should they remain after merge into main? one can always retrieve the merge point with the tag (e.g. for hotfixes)

---

### [Comment #2](https://github.com/vig-os/sync-issues-action/pull/22#issuecomment-3946300156) by [@gerchowl](https://github.com/gerchowl)

_Posted on February 23, 2026 at 05:40 PM_

Id say the reason for it to exist is to allow dev to diverge while the release is being prepared. Once released i dont see the point in keeping it.

So anything dev has, should be fine.

A hotfix as in patch will bump the version X.Y.Z+1 so it should be a new rc anyway?!

---
---

## Review Threads (4)

### Review by [@Copilot](https://github.com/apps/copilot-pull-request-reviewer)

_Posted on February 23, 2026 at 02:47 PM_

_File: [`src/index.ts`](https://github.com/vig-os/sync-issues-action/pull/22#discussion_r2841261295)_

```diff
@@ -383,6 +398,70 @@ async function fetchComments(
   return comments;
 }
 
+const GRAPHQL_BATCH_SIZE = 50;
+
+export async function fetchIssueRelationships(
+  octokit: ReturnType<typeof github.getOctokit>,
+  owner: string,
+  repo: string,
+  issueNumbers: number[]
+): Promise<Map<number, IssueRelationship>> {
+  const relationships = new Map<number, IssueRelationship>();
+
+  if (issueNumbers.length === 0) {
+    return relationships;
+  }
+
+  try {
+    for (let i = 0; i < issueNumbers.length; i += GRAPHQL_BATCH_SIZE) {
+      const batch = issueNumbers.slice(i, i + GRAPHQL_BATCH_SIZE);
+
+      const issueFields = batch
+        .map(
+          (num) =>
+            `issue_${num}: issue(number: ${num}) {
+              parent { number }
+              subIssues(first: 100) { nodes { number } }
+            }`
+        )
+        .join('\n');
+
+      const query = `query($owner: String!, $repo: String!) {
+        repository(owner: $owner, name: $repo) {
+          ${issueFields}
+        }
+      }`;
+
+      const response: any = await octokit.graphql(query, {
+        owner,
+        repo,
+      });
+
+      for (const num of batch) {
+        const data = response.repository[`issue_${num}`];
+        if (data) {
+          relationships.set(num, {
+            parent: data.parent?.number ?? null,
+            children: (data.subIssues?.nodes ?? []).map((n: any) => n.number),
+          });
+        }
+      }
+    }
+  } catch (error) {
+    const message = error instanceof Error ? error.message : 'Unknown error';
+    if (message.includes("doesn't exist on type")) {
+      core.info(
+        'Sub-issues API is not available for this repository. Skipping relationship sync.'
+      );
+    } else {
+      core.warning(`Failed to fetch sub-issue relationships: ${message}`);
+    }
```

The error handling catches all errors and checks if the message includes "doesn't exist on type" to detect unavailable sub-issues API. However, this is a broad catch-all that could mask other errors. Consider being more specific about which field is missing (e.g., check for "parent" or "subIssues" specifically) to avoid silencing unrelated GraphQL errors.

Conversation:

- **[@c-vigo](https://github.com/c-vigo)** on February 23, 2026 at 03:02 PM — [link](https://github.com/vig-os/sync-issues-action/pull/22#discussion_r2841351577)

  The catch block already separates this case from other errors: the `"doesn't exist on type"` branch emits `core.info` (graceful degradation), while all other errors fall through to `core.warning`. Since that GraphQL error string is specific to unknown-field queries, unrelated errors are not silenced. Keeping the current approach.

---

### Review by [@Copilot](https://github.com/apps/copilot-pull-request-reviewer)

_Posted on February 23, 2026 at 02:47 PM_

_File: [`src/index.ts`](https://github.com/vig-os/sync-issues-action/pull/22#discussion_r2841261388)_

```diff
@@ -383,6 +398,70 @@ async function fetchComments(
   return comments;
 }
 
+const GRAPHQL_BATCH_SIZE = 50;
+
+export async function fetchIssueRelationships(
+  octokit: ReturnType<typeof github.getOctokit>,
+  owner: string,
+  repo: string,
+  issueNumbers: number[]
+): Promise<Map<number, IssueRelationship>> {
+  const relationships = new Map<number, IssueRelationship>();
+
+  if (issueNumbers.length === 0) {
+    return relationships;
+  }
+
+  try {
+    for (let i = 0; i < issueNumbers.length; i += GRAPHQL_BATCH_SIZE) {
+      const batch = issueNumbers.slice(i, i + GRAPHQL_BATCH_SIZE);
+
+      const issueFields = batch
+        .map(
+          (num) =>
+            `issue_${num}: issue(number: ${num}) {
+              parent { number }
+              subIssues(first: 100) { nodes { number } }
+            }`
+        )
+        .join('\n');
+
+      const query = `query($owner: String!, $repo: String!) {
+        repository(owner: $owner, name: $repo) {
+          ${issueFields}
+        }
+      }`;
+
+      const response: any = await octokit.graphql(query, {
+        owner,
+        repo,
+      });
+
+      for (const num of batch) {
+        const data = response.repository[`issue_${num}`];
+        if (data) {
+          relationships.set(num, {
+            parent: data.parent?.number ?? null,
+            children: (data.subIssues?.nodes ?? []).map((n: any) => n.number),
+          });
+        }
+      }
+    }
+  } catch (error) {
+    const message = error instanceof Error ? error.message : 'Unknown error';
+    if (message.includes("doesn't exist on type")) {
+      core.info(
+        'Sub-issues API is not available for this repository. Skipping relationship sync.'
+      );
+    } else {
+      core.warning(`Failed to fetch sub-issue relationships: ${message}`);
+    }
+    return new Map();
+  }
```

The function returns an empty Map on error after attempting all batches, but errors occurring during batch processing will immediately return an empty Map and skip remaining batches. This means if batches 1-3 succeed and batch 4 fails, batches 5+ won't be processed. Consider whether partial results should be returned instead of discarding all successfully fetched relationships.

Conversation:

- **[@c-vigo](https://github.com/c-vigo)** on February 23, 2026 at 03:02 PM — [link](https://github.com/vig-os/sync-issues-action/pull/22#discussion_r2841351633)

  Good catch. In practice the most likely error (`"doesn't exist on type"`) fails on the first batch, so partial results rarely apply. For transient mid-batch errors, returning partials is a valid improvement. Tracked in #25.

---

### Review by [@Copilot](https://github.com/apps/copilot-pull-request-reviewer)

_Posted on February 23, 2026 at 02:47 PM_

_File: [`src/index.ts`](https://github.com/vig-os/sync-issues-action/pull/22#discussion_r2841261423)_

```diff
@@ -198,14 +210,15 @@ async function syncIssuesToMarkdown(
   repo: string,
   outputDir: string,
   includeClosed: boolean,
-  updatedSince?: string
+  updatedSince?: string,
+  forceUpdate = false,
+  syncSubIssues = false
```

The `syncSubIssues` parameter defaults to `false` but should default to `true` to match the action input default and the PR description. The action.yml shows `sync-sub-issues` defaults to `'true'` (line 47), and line 131 correctly parses it as `true` by default, but this function signature shows `false`.

Conversation:

- **[@c-vigo](https://github.com/c-vigo)** on February 23, 2026 at 03:02 PM — [link](https://github.com/vig-os/sync-issues-action/pull/22#discussion_r2841351712)

  Good eye — while the caller always passes the value explicitly (so no runtime impact today), the default should match the action definition for consistency. Tracked in #26.

---

### Review by [@gerchowl](https://github.com/gerchowl)

_Posted on February 24, 2026 at 05:20 PM_

_File: [`.github/workflows/codeql.yml (line 25 RIGHT)`](https://github.com/vig-os/sync-issues-action/pull/22#discussion_r2848509350)_

```diff
@@ -1,25 +1,61 @@
-# CodeQL Analysis Workflow
+# CodeQL Static Analysis
 #
-# This workflow placeholder is registered with GitHub to enable CodeQL security scanning.
-# It performs static analysis on the codebase to detect potential vulnerabilities and code quality issues.
-# Full implementation details are managed separately.
+# Runs GitHub CodeQL analysis on the TypeScript codebase.
+#
+# Triggers:
+#   - Pull requests to dev, release/**, and main
+#   - Pushes to main (post-merge analysis)
+#   - Weekly schedule (catch newly disclosed patterns)
 
 name: CodeQL
 
-"on":
-  pull_request:  # TODO: consider restricting to protected branches (dev, main, release/**) when implementing
-  push:
+on:  # yamllint disable-line rule:truthy
+  pull_request:
     branches:
       - dev
+      - 'release/**'
+      - main
+    paths:
+      - '**.ts'
+  push:
+    branches:
       - main
-      # TODO: add schedule trigger (e.g. weekly cron) for drift detection when implementing
+    paths:
+      - '**.ts'
+  schedule:
```

drift from what? dependabot or sth. updating without triggering CodeQL? or does codeQL behave like dependabot checking external libs for changes?

---


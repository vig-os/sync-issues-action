---
type: pull_request
state: open
branch: feature/13-ci-cd-workflows → dev
created: 2026-02-20T16:41:37Z
updated: 2026-02-23T09:36:30Z
author: c-vigo
author_url: https://github.com/c-vigo
url: https://github.com/vig-os/sync-issues-action/pull/14
comments: 0
labels: none
assignees: c-vigo
milestone: none
projects: none
relationship: none
synced: 2026-02-23T09:42:19.686Z
---

# [PR 14](https://github.com/vig-os/sync-issues-action/pull/14) ci: develop and validate CI/CD workflows

## Description

Implement the full CI/CD pipeline for the project: continuous integration checks on pull requests, a three-phase release process (prepare → release → post-release), security scanning, integration testing, and supporting composite actions and tooling.

## Type of Change

- [ ] `feat` -- New feature
- [ ] `fix` -- Bug fix
- [ ] `docs` -- Documentation only
- [x] `chore` -- Maintenance task (deps, config, etc.)
- [ ] `refactor` -- Code restructuring (no behavior change)
- [x] `test` -- Adding or updating tests
- [x] `ci` -- CI/CD pipeline changes
- [x] `build` -- Build system or dependency changes
- [ ] `revert` -- Reverts a previous commit
- [ ] `style` -- Code style (formatting, whitespace)

### Modifiers

- [ ] Breaking change (`!`) -- This change breaks backward compatibility

## Changes Made

### CI Workflow (`ci.yml`)

- Lint, build, test, integration-test, dependency-review, and summary gate jobs on PRs to `dev`, `release/**`, and `main`
- Manual `workflow_dispatch` with selectable test suite

### Three-Phase Release Process

- **Phase 1 — Prepare Release** (`prepare-release.yml`): create `release/X.Y.Z` branch, prepare CHANGELOG heading, open draft PR to `main`
- **Phase 2 — Release** (`release.yml`): validate prerequisites, finalize CHANGELOG date + `package.json` version, run full test suite on finalized code, create `vX.Y.Z` tag with provenance, publish GitHub Release with auto-generated notes, update floating tags (`vX`, `vX.Y`), automatic rollback with failure-issue on error
- **Phase 3 — Post-Release** (`post-release.yml`): merge `main` back into `dev`, reset CHANGELOG Unreleased section for the next cycle
- Dry-run mode across all phases with deep preview (CHANGELOG diff, version bump preview, tag listing)

### Security Workflows

- CodeQL static analysis on PRs and pushes (`codeql.yml`)
- OpenSSF Scorecard supply-chain security analysis uploading SARIF to the Security tab (`scorecard.yml`)

### Integration Testing

- Reusable `integration-test.yml` workflow called by CI and release, running 4 scenarios: issues-only, PRs-only, force-update, and include-closed

### Composite Actions

- `setup-env` — consistent Node.js installation (version from `.nvmrc`), npm dependency caching, optional `uv` install for pre-commit
- `build-dist` — ncc bundling with dist/ diff verification to prevent stale compiled output

### Release Tooling

- `prepare_changelog.py` — standalone Python 3 CLI (zero external deps) for CHANGELOG heading management, date stamping, and Unreleased section reset, with unit tests (`test_prepare_changelog.py`)
- `release_helpers.sh` — shell helper functions for release validation, with tests (`test_release_helpers.sh`)

### Configuration & Maintenance

- Dependabot configuration for weekly Actions (sha-pinned) and npm dependency updates targeting `dev`
- `.nvmrc` pinning Node.js 20 as single source of truth for CI, devcontainer, and local development
- `CODEOWNERS` file for automated review assignment
- Overhauled issue templates: `bug`, `chore`, `discussion`, `docs`, `feature`, `refactor` (removed generic `task`)
- Updated PR template with conventional-commit type checkboxes, changelog entry section, and refs footer
- Pre-commit config: removed Python checks, switched `uv run` to `uvx` for pre-commit invocation
- Removed source maps from `dist/` to fix CI dist staleness checks
- `sync-issues.yml` updated to use local action (`uses: ./`) and GitHub App token for cache deletion

## Changelog Entry

No changelog needed — all changes are CI/CD pipeline internals, repo configuration, and contributor tooling with no user-visible behavior change to the action itself.

## Testing

- [x] Tests pass locally (`npm test`)
- [x] Manual testing performed (describe below)

### Manual Testing Details

- Workflows validated via pre-commit YAML linting (`yamllint`), action-pin checks, and shellcheck
- `prepare_changelog.py` unit tests: `python -m pytest .github/tests/test_prepare_changelog.py`
- `release_helpers.sh` unit tests: `bash .github/tests/test_release_helpers.sh`
- Full end-to-end workflow testing requires a push to the remote and observing GitHub Actions runs

## Checklist

- [x] My code follows the project's style guidelines
- [x] I have performed a self-review of my code
- [x] I have commented my code, particularly in hard-to-understand areas
- [x] I have updated the documentation accordingly
- [x] I have updated `CHANGELOG.md` in the `[Unreleased]` section (and pasted the entry above)
- [x] My changes generate no new warnings or errors
- [x] I have added tests that prove my fix is effective or that my feature works
- [x] New and existing unit tests pass locally with my changes
- [x] Any dependent changes have been merged and published

## Additional Notes

The `build-dist` action enforces that `dist/` is always committed in sync with source — any PR with stale dist will fail the CI `build` job. The `.nvmrc` file ensures local devcontainer and CI always use the same Node.js major version; bumping Node requires only a single-line change.

The release process uses a GitHub App token (`APP_ID` / `APP_PRIVATE_KEY` secrets) for operations that need to bypass branch protection rules (pushing to release branches, creating tags). The `GITHUB_TOKEN` is used everywhere else with least-privilege permissions.

`prepare_changelog.py` is a temporary in-repo tool that will eventually be extracted into a standalone GitHub Action or pip package.

Refs: #13

---
type: pull_request
state: closed (merged)
branch: bugfix/34-error-immutable-releases â†’ dev
created: 2026-02-25T19:27:31Z
updated: 2026-02-25T19:30:44Z
author: c-vigo
author_url: https://github.com/c-vigo
url: https://github.com/vig-os/sync-issues-action/pull/36
comments: 0
labels: none
assignees: none
milestone: none
projects: none
relationship: none
merged: 2026-02-25T19:30:38Z
synced: 2026-02-25T19:31:13.231Z
---

# [PR 36](https://github.com/vig-os/sync-issues-action/pull/36) fix: avoid immutable release upload failures in release workflow

## Description

Fixes release publishing failures caused by immutable release state when uploading artifacts after release creation. The workflow now prepares checksum artifacts before release creation and hardens floating tag SHA resolution/rollback handling.

## Type of Change

- [ ] `feat` -- New feature
- [x] `fix` -- Bug fix
- [ ] `docs` -- Documentation only
- [ ] `chore` -- Maintenance task (deps, config, etc.)
- [ ] `refactor` -- Code restructuring (no behavior change)
- [ ] `test` -- Adding or updating tests
- [x] `ci` -- CI/CD pipeline changes
- [ ] `build` -- Build system or dependency changes
- [ ] `revert` -- Reverts a previous commit
- [ ] `style` -- Code style (formatting, whitespace)

### Modifiers

- [ ] Breaking change (`!`) -- This change breaks backward compatibility

## Changes Made

- Generate `checksums-sha256.txt` before creating the GitHub release.
- Attach checksums during `gh release create` instead of uploading after release creation.
- Resolve floating tags with `git/matching-refs/tags/*` and only accept valid 40-char SHAs.
- Skip rollback restore/delete operations when the previous SHA is present but invalid.
- Add corresponding `[Unreleased]` changelog entry.

## Changelog Entry

### Fixed

- **Release workflow avoids immutable-release upload failures**
  - Generates `checksums-sha256.txt` before creating the GitHub release and attaches it during `gh release create` instead of uploading afterward
  - Hardens floating-tag SHA handling by resolving tags via `git/matching-refs`, validating SHA format, and skipping invalid rollback SHAs

## Testing

- [ ] Tests pass locally (`npm test`)
- [x] Manual testing performed (describe below)

### Manual Testing Details

- Verified workflow logic changes by reviewing command flow in `.github/workflows/release.yml`.
- Confirmed release command now includes checksum asset at creation time.
- Confirmed tag SHA retrieval and rollback paths now validate SHA format.

## Checklist

- [x] My code follows the project's style guidelines
- [x] I have performed a self-review of my code
- [ ] I have commented my code, particularly in hard-to-understand areas
- [x] I have updated the documentation accordingly
- [x] I have updated `CHANGELOG.md` in the `[Unreleased]` section (and pasted the entry above)
- [x] My changes generate no new warnings or errors
- [ ] I have added tests that prove my fix is effective or that my feature works
- [ ] New and existing unit tests pass locally with my changes
- [ ] Any dependent changes have been merged and published

## Additional Notes

No functional changes outside the release workflow and changelog update.

Refs: #34


---
---

## Commits

### Commit 1: [df4b531](https://github.com/vig-os/sync-issues-action/commit/df4b531c0b19be9eacd86bf75bd4a13e2073dac5) by [c-vigo](https://github.com/c-vigo) on February 25, 2026 at 07:26 PM
fix: avoid immutable release upload failures in release workflow, 49 files modified (.github/workflows/release.yml, CHANGELOG.md)

### Commit 2: [45683e1](https://github.com/vig-os/sync-issues-action/commit/45683e14b89f11b1414af0830360929d4020e418) by [c-vigo](https://github.com/c-vigo) on February 25, 2026 at 07:29 PM
chore: update CHANGELOG to reflect unreleased changes, 2 files modified (CHANGELOG.md)
